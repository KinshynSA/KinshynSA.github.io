"use strict";function _createForOfIteratorHelper(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,c=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){c=!0,r=e},f:function(){try{o||null==a.return||a.return()}finally{if(c)throw r}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}document.addEventListener("click",function(e){if(e.target.closest(".tickets_popup-caller"))new Popup});var Popup=function(){function e(t){_classCallCheck(this,e),this.params=t,this.fields=[{name:"name",type:"text",label:"ФИО",requiered:"requiered"},{name:"email",type:"email",label:"Email",requiered:"requiered"},{name:"phone",type:"tel",label:"Телефон",mask:"+{38}(000)-000-00-00",requiered:"requiered"},{name:"tickets",label:"Количество билетов",select:!0,value:1,options:[{name:"1",value:1},{name:"2",value:2},{name:"3",value:3},{name:"4",value:4},{name:"5",value:5}]}],this.verified=!1,this.close=this.close.bind(this),this.onInput=this.onInput.bind(this),this.onChange=this.onChange.bind(this),this.createPopup()}return _createClass(e,[{key:"createNode",value:function(e){var t=document.createElement("".concat(e.tag?e.tag:"div"));for(var a in e)"cl"===a&&e.cl&&(Array.isArray(e.cl)?e.cl.forEach(function(e){return t.classList.add(e)}):t.classList.add(e.cl)),"text"===a&&e.text&&(t.textContent=e.text),"datasetValue"===a&&e.datasetValue&&(t.dataset.value=e.datasetValue),"mask"===a&&e.mask&&this.setMask(t,e.mask),t[a]=e[a];return t}},{key:"createPopup",value:function(){var e=this;this.container=this.createNode({cl:["tickets_popup_container","active"]}),this.bg=this.createNode({cl:"tickets_popup_background",onclick:this.close}),this.content=this.createNode({cl:"tickets_popup_content"}),this.close=this.createNode({cl:"tickets_popup_close",onclick:this.close,innerHTML:'<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t<path d="M14 1.41L12.59 0L7 5.59L1.41 0L0 1.41L5.59 7L0 12.59L1.41 14L7 8.41L12.59 14L14 12.59L8.41 7L14 1.41Z" fill="black"/>\n\t\t\t\t\t\t</svg>'}),this.form=this.createNode({cl:"tickets_form"}),this.formBox=this.createNode({cl:"tickets_form_box"}),this.fields.forEach(function(t){e.formBox.append(e.createItem(t))}),this.formBox.append(this.createButtonSubmit()),this.container.append(this.bg),this.container.append(this.content),this.content.append(this.close),this.content.append(this.form),this.form.append(this.formBox),document.querySelector("body").append(this.container)}},{key:"createItem",value:function(e){var t=this,a=this.createNode({cl:"tickets_form_item"});if(e.label){var n=this.createNode({tag:"span",cl:"tickets_form_item_label",text:e.label});if(e.requiered){var i=this.createNode({tag:"span",cl:"tickets_form_item_label_star",text:" *"});n.append(i)}a.append(n)}if(e.select){var r,o=this.createNode({cl:"tickets_select"});e.options.forEach(function(e){e.def&&(r=e)}),r||(r=e.options[0]);var c=this.createNode({tag:"input",type:"text",name:"".concat(e.name?e.name:""),cl:"tickets_hidden",value:r.value}),s=this.createNode({cl:"tickets_select_tit",text:r.name,onclick:function(){l.classList.toggle("active")}}),l=this.createNode({cl:"tickets_select_list"});e.options.forEach(function(a){l.append(t.createNode({cl:"tickets_select_list_item",text:a.name,datasetValue:a.value,onclick:function(t){c.value=a.value,e.value=a.value,s.textContent=a.name,l.classList.remove("active")}}))}),o.append(s),o.append(l),o.append(c),a.append(o)}else{var u=this.createNode({tag:"input",type:"".concat(e.type?e.type:"text"),name:"".concat(e.name?e.name:""),requiered:e.requiered,oninput:this.onInput,onchange:this.onChange,mask:e.mask}),d=this.createNode({tag:"span",cl:"tickets_form_item_error",text:"Проверьте введенные данные"});a.append(u),a.append(d)}return a}},{key:"createButtonSubmit",value:function(){var e=this.createNode({cl:["tickets_form_item","tickets_form_item_button"]}),t=this.createNode({cl:"tickets_button",tag:"button",text:"Купить",onclick:function(){alert("submit")}});return this.button=t,this.button.disabled=!0,e.append(t),e}},{key:"onInput",value:function(e){e.target.classList.contains("repeated")&&this.checkField(e)}},{key:"onChange",value:function(e){e.target.classList.contains("repeated")||e.target.classList.add("repeated"),this.checkField(e)}},{key:"checkField",value:function(e){var t=e.target,a=t.name,n=t.value;if(t.requiered){var i=!1;switch(a){case"phone":12!==n.replace(/\D/g,"").length&&(i=!0);break;case"email":/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(n).toLowerCase())||(i=!0);break;case"name":n.length||(i=!0)}return i?t.classList.add("invalid"):t.classList.remove("invalid"),this.checkFields(a,n,i),i}this.checkFields(a,n,!1)}},{key:"checkFields",value:function(e,t,a){var n,i=!0,r=_createForOfIteratorHelper(this.fields);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.name===e&&(o.value=t,o.error=a),(o.error||o.requiered&&void 0===o.value)&&(i=!1)}}catch(e){r.e(e)}finally{r.f()}this.verified=i,this.button.disabled=!i}},{key:"setMask",value:function(e,t){IMask(e,{mask:t})}},{key:"close",value:function(){var e=this;this.container.classList.remove("active"),setTimeout(function(){e.container.remove()},4e3)}}]),e}();